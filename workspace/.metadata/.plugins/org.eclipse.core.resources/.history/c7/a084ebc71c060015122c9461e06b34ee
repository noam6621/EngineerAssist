package jce.project.noam.engineerassist.utils;

import java.io.BufferedWriter;
import java.io.IOException;
import java.nio.charset.Charset;
import java.nio.file.Files;
import java.nio.file.Paths;

/**
 * Handles writing to XML file.
 * @author Noam S.
 *
 */
public class XMLWriter {
	
	private BufferedWriter xmlOut;
	
	public XMLWriter(String path) throws IOException {
		if (path.endsWith(".pdf")) {
			xmlOut = Files.newBufferedWriter(Paths.get(path.substring(0, path.length() - ".pdf".length()) + ".xml"), Charset.forName("UTF-8"));
		}
		else if (path.endsWith(".xml")) {
			xmlOut = Files.newBufferedWriter(Paths.get(path), Charset.forName("UTF-8"));
		}
		else {
			xmlOut = Files.newBufferedWriter(Paths.get(path + "\\out.xml"), Charset.forName("UTF-8"));
		}
		// TODO Write to output file XML opening
		
	}

	private void write(String text) throws IOException {
		xmlOut.write(text);
		xmlOut.newLine();
		xmlOut.flush();
	}

	public void writeXMLStart() throws IOException {
		write("<?xml version=\"1.0\" encoding=\"UTF-8\" ?>");
		write("<add>");
	}

	public void writeXMLEnd() throws IOException {
		write("</add>");
		System.out.println("Wrote XML end!");
	}
	
	public void writeDocStart() throws IOException {
		write("<doc>");
	}

	public void writeDocEnd() throws IOException {
		write("</doc>");
	}

	public void writeField(String type, String text) throws IOException {
		xmlOut.write("<field name=\"" + type + "\">" + text + "</field>");
	}

}
